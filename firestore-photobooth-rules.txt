// Firebase Security Rules Update for Photobooth System
// Add these rules to your existing firestore.rules file

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ... existing rules ...
    
    // Photobooth Print Queue Collection
    match /printQueue/{docId} {
      // Anyone authenticated can read print queue
      allow read: if request.auth != null;
      
      // Only staff and admin can create print jobs
      allow create: if request.auth != null && 
        (get(/databases/$(database)/documents/registrations/$(request.auth.uid)).data.role in ["staff", "admin"]);
      
      // Staff, admin, and printer client can update status
      allow update: if request.auth != null;
      
      // Only admin can delete
      allow delete: if request.auth != null && 
        get(/databases/$(database)/documents/registrations/$(request.auth.uid)).data.role == "admin";
    }
    
    // Photobooth checkins are handled by existing checkins collection rules
    // No additional rules needed
  }
}
